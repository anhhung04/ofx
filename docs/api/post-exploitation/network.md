# Network API

Network utilities for port scanning, service detection, and network reconnaissance.

## Module: `ofx.api.network`

Provides network utilities for offensive security operations.

## Functions

### port_scan

Perform port scanning on target hosts.

```python
from ofx.api.network import port_scan

# Scan common ports
results = port_scan("192.168.1.1", ports=[80, 443, 22, 21])

# Scan port range
results = port_scan("example.com", port_range=(1, 1024))

# Parallel scanning
results = port_scan(
    targets=["192.168.1.1", "192.168.1.2"],
    ports=[80, 443],
    threads=10
)
```

**Parameters**:
- `target` (str | list): Target IP or hostname(s)
- `ports` (list[int], optional): Specific ports to scan
- `port_range` (tuple, optional): Port range (start, end)
- `threads` (int): Number of threads (default: 10)
- `timeout` (float): Connection timeout (default: 1.0)

**Returns**: `dict` - Scan results with open ports

### service_detect

Detect services running on open ports.

```python
from ofx.api.network import service_detect

# Detect services
services = service_detect("192.168.1.1", ports=[80, 443, 22])

# Output:
# {
#   80: {"service": "http", "version": "Apache/2.4.41"},
#   443: {"service": "https", "version": "nginx/1.18.0"},
#   22: {"service": "ssh", "version": "OpenSSH_8.2"}
# }
```

**Parameters**:
- `target` (str): Target IP or hostname
- `ports` (list[int]): Ports to probe  
- `timeout` (float): Probe timeout

**Returns**: `dict` - Service information per port

### resolve_hostname

Resolve hostname to IP addresses.

```python
from ofx.api.network import resolve_hostname

# Resolve DNS
ips = resolve_hostname("example.com")
# Returns: ["93.184.216.34"]

# Get all records
records = resolve_hostname("example.com", record_type="ALL")
```

**Parameters**:
- `hostname` (str): Hostname to resolve
- `record_type` (str): DNS record type (default: "A")

**Returns**: `list[str]` - IP addresses

### reverse_lookup

Perform reverse DNS lookup.

```python
from ofx.api.network import reverse_lookup

# Reverse lookup
hostname = reverse_lookup("93.184.216.34")
# Returns: "example.com"
```

**Parameters**:
- `ip` (str): IP address

**Returns**: `str` - Hostname

## Classes

### NetworkScanner

Advanced network scanner with multiple techniques.

```python
from ofx.api.network import NetworkScanner

scanner = NetworkScanner()

# SYN scan (requires root)
results = scanner.syn_scan("192.168.1.1", ports=[80, 443])

# TCP connect scan
results = scanner.tcp_scan("192.168.1.1", ports=[22, 80, 443])

# UDP scan
results = scanner.udp_scan("192.168.1.1", ports=[53, 161])
```

**Methods**:
- `syn_scan()` - TCP SYN scan (stealth)
- `tcp_scan()` - TCP connect scan
- `udp_scan()` - UDP scan
- `banner_grab()` - Grab service banners

## Examples

### Port Scan with Service Detection

```python
from ofx.api.network import port_scan, service_detect

# Scan ports
open_ports = port_scan("example.com", port_range=(1, 1000))

# Detect services on open ports
services = service_detect("example.com", ports=open_ports)

for port, info in services.items():
    print(f"Port {port}: {info['service']} {info.get('version', '')}")
```

### Network Range Scan

```python
from ofx.api.network import NetworkScanner
from ipaddress import IPv4Network

scanner = NetworkScanner()

# Scan subnet
network = IPv4Network("192.168.1.0/24")
for ip in network.hosts():
    results = scanner.tcp_scan(str(ip), ports=[80, 443])
    if results:
        print(f"{ip}: {results}")
```

## See Also

- [HTTP API](../exploitation/http.md)
- [Reconnaissance](../reconnaissance/index.md)
